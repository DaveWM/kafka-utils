<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><title>kafka-utils.core documentation</title><link rel="stylesheet" type="text/css" href="css/default.css" /><link rel="stylesheet" type="text/css" href="css/highlight.css" /><script type="text/javascript" src="js/highlight.min.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/page_effects.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name">Kafka-utils</span> <span class="project-version">0.1.1</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1 current"><a href="kafka-utils.core.html"><div class="inner"><span>kafka-utils.core</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="kafka-utils.core.html#var--.3Echan"><div class="inner"><span>-&gt;chan</span></div></a></li><li class="depth-1"><a href="kafka-utils.core.html#var-apply-transducer"><div class="inner"><span>apply-transducer</span></div></a></li><li class="depth-1"><a href="kafka-utils.core.html#var-as-of"><div class="inner"><span>as-of</span></div></a></li><li class="depth-1"><a href="kafka-utils.core.html#var-latest-only"><div class="inner"><span>latest-only</span></div></a></li><li class="depth-1"><a href="kafka-utils.core.html#var-read-from-beginning"><div class="inner"><span>read-from-beginning</span></div></a></li><li class="depth-1"><a href="kafka-utils.core.html#var-read-from-end"><div class="inner"><span>read-from-end</span></div></a></li><li class="depth-1"><a href="kafka-utils.core.html#var-sink-to-db.21"><div class="inner"><span>sink-to-db!</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">kafka-utils.core</h1><div class="doc"><pre class="plaintext"></pre></div><div class="public anchor" id="var--.3Echan"><h3>-&gt;chan</h3><div class="usage"><code>(-&gt;chan consumer)</code><code>(-&gt;chan consumer poll-timeout)</code></div><div class="doc"><pre class="plaintext">Reads messages from a Kafka topic, using the provided consumer, into a core.async channel. Returns the channel.

Each message in the topic will be put on the channel individually.

Each message is augmented with these keys:
  - :kafka.record/key
  - :kafka.record/timestamp
  - :kafka.record/offset
  - :kafka.record/topic
  - :kafka.record/partition

Closing the returned channel will also close the consumer.</pre></div></div><div class="public anchor" id="var-apply-transducer"><h3>apply-transducer</h3><div class="usage"><code>(apply-transducer xf in-chan)</code></div><div class="doc"><pre class="plaintext">Takes a channel, applies a transducer to it, and returns the new channel. The original channel is not modified.
</pre></div></div><div class="public anchor" id="var-as-of"><h3>as-of</h3><div class="usage"><code>(as-of db timestamp)</code></div><div class="doc"><pre class="plaintext">Returns the state of the db at the given time, as determined by the Kafka record timestamp
</pre></div></div><div class="public anchor" id="var-latest-only"><h3>latest-only</h3><div class="usage"><code>(latest-only db id-attr)</code></div><div class="doc"><pre class="plaintext">Returns a db containing only the latest message for each entity. This is useful for changelog topics.

Entities are determined using the 'id-attr' parameter.

The offset is used to determine which message is the latest one.</pre></div></div><div class="public anchor" id="var-read-from-beginning"><h3>read-from-beginning</h3><div class="usage"><code>(read-from-beginning topic-name bootstrap-servers key-deserializer value-deserializer)</code></div><div class="doc"><pre class="plaintext">Reads a topic from the beginning (i.e. offset 0) of a topic into a core.async channel
</pre></div></div><div class="public anchor" id="var-read-from-end"><h3>read-from-end</h3><div class="usage"><code>(read-from-end topic-name bootstrap-servers key-deserializer value-deserializer)</code></div><div class="doc"><pre class="plaintext">Reads a topic from the end (i.e. the latest offset) of a topic into a core.async channel.
</pre></div></div><div class="public anchor" id="var-sink-to-db.21"><h3>sink-to-db!</h3><div class="usage"><code>(sink-to-db! chan db-conn)</code></div><div class="doc"><pre class="plaintext">Takes each message on a core.async channel, and inserts it into the provided datascript db.

The datascript id of each message is calculated from the :kafka.record/offset, :kafka.record/partition and :kafka.record/topic keys.</pre></div></div></div></body></html>